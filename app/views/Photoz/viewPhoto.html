#{extends 'main.html' /}
#{set 'title'}
	 &{'pictures'}
#{/set}

#{isMine}
#{script 'jquery.imgareaselect.comments.js'/}
#{script 'ui.core.js'/}
#{script 'ui.draggable.js'/}
#{script 'ui.resizable.js'/}
#{stylesheet 'imgareaselect-default.css'/}
#{stylesheet 'themes/base/ui.all.css'/}


<style type="text/css">
td{
	text-align:center;
	width: 154px;
}
textarea{
	width:100%;
	height:26px;
}
.imgtd {
}
.captd {
}
.sayHello{
	background:0px;
}
.sayHello img{
	padding:0px;
	border:0px;
	background:none;
}
</style>

<script>
	function rotateLeft(id){
		$.post('@{Photoz.rotateLeft()}',{id:id},function(){			
			window.location.reload();
		})
	}
	function rotateRight(id){
		$.post('@{Photoz.rotateRight()}',{id:id},function(){			
			window.location.reload();
		})
	}
	function sayHello(id){
		var editor=$("#sayHello")		
		if(editor.is(':visible'))return;
		var tdpos = $("#imgtd").position();		
		editor.css('top',tdpos.top+'px')
		editor.css('left',tdpos.left+'px')		
		$("#imgtd").append(editor);
		editor.show();
		//
		editor.draggable();
		editor.find("#hello-img").resizable();
	}
	function cancelHello(a){
		$(a).closest('div').remove();
	}
	function saveHello(a){		
		var editor = $(a).closest('div')
		var pos = editor.find('#hello-img').offsetParent();
		var content = editor.find("#content").val();
		
	}
</script>

<div id='sayHello' class='sayHello' style='display:none;position:absolute;width:100px;height:122px;'>	
	<div id='hello-img'>
		<img src='/public/images/hello2.gif' style='width:100%;height:100%;'/>
	</div>
	<table width="100px;height:62px;margin:0px;border:0px;">
		<tr style="height:40px"><td style="border:0px;padding:0px"><textarea id="content"></textarea></td></tr>
		<tr style="height:22px;"><td style="border:0px;padding:0px"><a onclick="saveHello(this)">save</a><a onclick="cancelHello(this)"> cancel</a></td></tr>
	</table>	
</div>
#{/isMine}

<div style="clear:both">
	<a onclick="return fasle;" href='javascript:history.go(-1)'>&{'returnToList'}</a>
#{isMine}
	<a href='#' onclick="rotateRight((${photo.id}))">&{'rotateRight'}</a>
	<a href='#' onclick="rotateLeft((${photo.id}))">&{'rotateLeft'}</a>
	<a href='#' onclick="sayHello((${photo.id}))">&{'sayHello'}</a>
#{/isMine}	
</div>

<table>
<tr>
<td id='imgtd'>
	<img id='photo' src="/${photo.prefPath}"/>
</td>
</tr>
</table>

<script type="text/javascript"> 

</script>
